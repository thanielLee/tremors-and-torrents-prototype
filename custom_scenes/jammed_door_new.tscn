[gd_scene load_steps=19 format=3 uid="uid://ciy4kh1na180s"]

[ext_resource type="Script" uid="uid://bncqx1dnbni5" path="res://scripts/jammed_door.gd" id="1_fhsa8"]
[ext_resource type="Resource" uid="uid://dr0e0rubyea1s" path="res://custom_scenes/rumble_hammer_hit.tres" id="2_k5fiq"]
[ext_resource type="Resource" uid="uid://bd6naymyuk7d" path="res://custom_scenes/rumble_door_break.tres" id="3_mhx7e"]
[ext_resource type="PackedScene" uid="uid://ctvlhcy5xcwta" path="res://assets/door_group.glb" id="4_b3thj"]
[ext_resource type="PackedScene" uid="uid://bj4kyk4a8l88b" path="res://assets/meshes/broken_door.glb" id="5_k5fiq"]
[ext_resource type="AudioStream" uid="uid://dnc4e28cyp0ba" path="res://assets/door_break_sound.mp3" id="5_y76gc"]
[ext_resource type="AudioStream" uid="uid://868abxtawv22" path="res://assets/hammer_hit.ogg" id="6_6tnag"]
[ext_resource type="Script" uid="uid://bcthi45shbpg5" path="res://custom_scenes/hit_point.gd" id="7_idebh"]
[ext_resource type="Script" uid="uid://cci3xkvnplit7" path="res://addons/ateneo-virtual-reality-escape/object-interaction-system/ois-receiver/ois_strike_receiver.gd" id="8_iw71t"]
[ext_resource type="PackedScene" uid="uid://bg8y0ctfrg7mx" path="res://vfx/vfx_hammer_impact.tscn" id="9_ov5sr"]

[sub_resource type="BoxShape3D" id="BoxShape3D_y4oq6"]
size = Vector3(0.15, 2.49945, 1.05786)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_y4oq6"]
albedo_color = Color(1, 0, 1, 1)

[sub_resource type="BoxMesh" id="BoxMesh_wqk2x"]
material = SubResource("StandardMaterial3D_y4oq6")
size = Vector3(0.1, 2, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_b27y7"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_tlv6m"]
material = SubResource("StandardMaterial3D_b27y7")
size = Vector3(0.15, 0.2, 0.2)

[sub_resource type="BoxShape3D" id="BoxShape3D_cyhyk"]
size = Vector3(0.15, 0.2, 0.2)

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_b27y7"]
emission_shape_offset = Vector3(0.07, 0, 0)
emission_shape = 1
emission_sphere_radius = 0.15

[sub_resource type="BoxMesh" id="BoxMesh_cyhyk"]
size = Vector3(0.05, 0.05, 0.05)

[node name="JammedDoor" type="Node3D"]
script = ExtResource("1_fhsa8")
strike_rumble_event = ExtResource("2_k5fiq")
break_rumble_event = ExtResource("3_mhx7e")

[node name="StaticBody3D" type="StaticBody3D" parent="."]
collision_layer = 536870913
collision_mask = 536870913

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0265198, 0.000854492)
shape = SubResource("BoxShape3D_y4oq6")

[node name="Mesh" type="Node3D" parent="."]

[node name="MeshInstance3D" type="MeshInstance3D" parent="Mesh"]
visible = false
mesh = SubResource("BoxMesh_wqk2x")
skeleton = NodePath("../..")

[node name="door_group" parent="Mesh" instance=ExtResource("4_b3thj")]
transform = Transform3D(-5.55135e-08, 0, -1.27, 0, 1.27, 0, 1.27, 0, -5.55135e-08, 6.23017, -1.27172, 4.19052)
visible = false

[node name="broken_door" parent="Mesh" instance=ExtResource("5_k5fiq")]
transform = Transform3D(-5.46392e-08, 0, -1.25, 0, 1.25124, 0, 1.25, 0, -5.46392e-08, 0.0136336, -1.24536, 0)

[node name="BreakSound" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("5_y76gc")
volume_db = -0.5

[node name="BreakDoorSound" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("5_y76gc")

[node name="HitSound" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("6_6tnag")

[node name="HitPoints" type="Node3D" parent="."]

[node name="HitPoint" type="Node3D" parent="HitPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.16605, 0.408375)
script = ExtResource("7_idebh")

[node name="Mesh" type="Node3D" parent="HitPoints/HitPoint"]
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="HitPoints/HitPoint/Mesh"]
mesh = SubResource("BoxMesh_tlv6m")
skeleton = NodePath("../..")

[node name="OISStrikeReceiver" type="Node3D" parent="HitPoints/HitPoint"]
script = ExtResource("8_iw71t")
strike_range = 10.0
group = "hammer"
requirement = 1.0
metadata/_custom_type_script = "uid://cci3xkvnplit7"

[node name="Area3D" type="Area3D" parent="HitPoints/HitPoint/OISStrikeReceiver"]
collision_layer = 536870912
collision_mask = 536870912

[node name="CollisionShape3D" type="CollisionShape3D" parent="HitPoints/HitPoint/OISStrikeReceiver/Area3D"]
shape = SubResource("BoxShape3D_cyhyk")

[node name="VfxHammerImpact" parent="HitPoints/HitPoint" instance=ExtResource("9_ov5sr")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.110815, 0, 0)

[node name="HitPoint2" type="Node3D" parent="HitPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.220267, 0.26553)
script = ExtResource("7_idebh")

[node name="Mesh" type="Node3D" parent="HitPoints/HitPoint2"]
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="HitPoints/HitPoint2/Mesh"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.132495, -0.0160562)
mesh = SubResource("BoxMesh_tlv6m")
skeleton = NodePath("../..")

[node name="OISStrikeReceiver" type="Node3D" parent="HitPoints/HitPoint2"]
script = ExtResource("8_iw71t")
strike_range = 10.0
group = "hammer"
requirement = 1.0
metadata/_custom_type_script = "uid://cci3xkvnplit7"

[node name="Area3D" type="Area3D" parent="HitPoints/HitPoint2/OISStrikeReceiver"]
collision_layer = 536870912
collision_mask = 536870912

[node name="CollisionShape3D" type="CollisionShape3D" parent="HitPoints/HitPoint2/OISStrikeReceiver/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.135943, -0.0159931)
shape = SubResource("BoxShape3D_cyhyk")

[node name="VfxHammerImpact" parent="HitPoints/HitPoint2" instance=ExtResource("9_ov5sr")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0976035, 0.0928482, 0)

[node name="HitPoint3" type="Node3D" parent="HitPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.337075, -0.422051)
script = ExtResource("7_idebh")

[node name="Mesh" type="Node3D" parent="HitPoints/HitPoint3"]
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="HitPoints/HitPoint3/Mesh"]
mesh = SubResource("BoxMesh_tlv6m")
skeleton = NodePath("../..")

[node name="OISStrikeReceiver" type="Node3D" parent="HitPoints/HitPoint3"]
script = ExtResource("8_iw71t")
strike_range = 10.0
group = "hammer"
requirement = 1.0
metadata/_custom_type_script = "uid://cci3xkvnplit7"

[node name="Area3D" type="Area3D" parent="HitPoints/HitPoint3/OISStrikeReceiver"]
collision_layer = 536870912
collision_mask = 536870912

[node name="CollisionShape3D" type="CollisionShape3D" parent="HitPoints/HitPoint3/OISStrikeReceiver/Area3D"]
shape = SubResource("BoxShape3D_cyhyk")

[node name="VfxHammerImpact" parent="HitPoints/HitPoint3" instance=ExtResource("9_ov5sr")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.124833, -0.0205875, 0)

[node name="HitPoint4" type="Node3D" parent="HitPoints"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.767311, 0.448622)
script = ExtResource("7_idebh")

[node name="Mesh" type="Node3D" parent="HitPoints/HitPoint4"]
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="HitPoints/HitPoint4/Mesh"]
mesh = SubResource("BoxMesh_tlv6m")
skeleton = NodePath("../..")

[node name="OISStrikeReceiver" type="Node3D" parent="HitPoints/HitPoint4"]
script = ExtResource("8_iw71t")
strike_range = 10.0
group = "hammer"
requirement = 1.0
metadata/_custom_type_script = "uid://cci3xkvnplit7"

[node name="Area3D" type="Area3D" parent="HitPoints/HitPoint4/OISStrikeReceiver"]
collision_layer = 536870912
collision_mask = 536870912

[node name="CollisionShape3D" type="CollisionShape3D" parent="HitPoints/HitPoint4/OISStrikeReceiver/Area3D"]
shape = SubResource("BoxShape3D_cyhyk")

[node name="VfxHammerImpact" parent="HitPoints/HitPoint4" instance=ExtResource("9_ov5sr")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.124833, -0.0205875, 0)

[node name="BreakParticles" type="GPUParticles3D" parent="."]
emitting = false
amount = 10
amount_ratio = 0.6236
lifetime = 0.5
one_shot = true
explosiveness = 0.16
randomness = 0.35
process_material = SubResource("ParticleProcessMaterial_b27y7")
draw_pass_1 = SubResource("BoxMesh_cyhyk")

[connection signal="finished" from="BreakDoorSound" to="." method="_on_break_door_sound_finished"]
